<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>1.2 Energy Discretization · Radiant</title><meta name="title" content="1.2 Energy Discretization · Radiant"/><meta property="og:title" content="1.2 Energy Discretization · Radiant"/><meta property="twitter:title" content="1.2 Energy Discretization · Radiant"/><meta name="description" content="Documentation for Radiant."/><meta property="og:description" content="Documentation for Radiant."/><meta property="twitter:description" content="Documentation for Radiant."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../quick_start/">Radiant</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Installation Guide</span><ul><li><a class="tocitem" href="../quick_start/">Quick Start</a></li></ul></li><li><span class="tocitem">Theory and Methodology</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox" checked/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">1 Radiation Transport</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../theory_transport_equation/">1.1 The Transport Equation</a></li><li class="is-active"><a class="tocitem" href>1.2 Energy Discretization</a><ul class="internal"><li><a class="tocitem" href="#1.2.1-Classical-Galerkin-Method-of-Weighted-Residuals"><span>1.2.1 Classical Galerkin Method of Weighted Residuals</span></a></li><li><a class="tocitem" href="#1.2.2-Multigroup-Discretization"><span>1.2.2 Multigroup Discretization</span></a></li><li><a class="tocitem" href="#1.2.3-Energy-Group-Structure"><span>1.2.3 Energy Group Structure</span></a></li><li><a class="tocitem" href="#1.2.4-Definition-of-soft-and-catastrophic-interactions"><span>1.2.4 Definition of soft and catastrophic interactions</span></a></li></ul></li><li><a class="tocitem" href="../theory_angular_discretization/">1.3 Angular Discretization</a></li><li><a class="tocitem" href="../theory_spatial_discretization/">1.4 Spatial Discretization</a></li><li><a class="tocitem" href="../theory_closure_relations/">1.5 Closure Relations</a></li><li><a class="tocitem" href="../theory_sweeping_process/">1.6 Sweeping Process</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">2 Cross-Sections</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-2-1"><span class="docs-label">2.1 Photons Interactions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../theory_rayleigh/">2.1.1 Rayleigh Scattering</a></li><li><a class="tocitem" href="../theory_compton/">2.1.2 Compton Scattering</a></li><li><a class="tocitem" href="../theory_photoelectric/">2.1.3 Photoelectric Effect</a></li><li><a class="tocitem" href="../theory_pair_production/">2.1.4 Pair Production</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2-2"><span class="docs-label">2.2 Electrons and Positrons Interactions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../theory_impact_ionization/">2.2.1 Impact Ionization</a></li><li><a class="tocitem" href="../theory_elastic_scattering/">2.2.2 Elastic Scattering</a></li><li><a class="tocitem" href="../theory_bremsstrahlung/">2.2.3 Bremsstrahlung</a></li><li><a class="tocitem" href="../theory_annihilation/">2.2.4 Annihilation</a></li></ul></li><li><a class="tocitem" href="../theory_atomic_relaxation/">2.3 Atomic Relaxation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">3 Mathematical Tools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../theory_polynomials/">3.1 Polynomials</a></li><li><a class="tocitem" href="../theory_quadrature/">3.2 Quadratures</a></li><li><a class="tocitem" href="../theory_interpolation/">3.3 Interpolations</a></li></ul></li><li><a class="tocitem" href="../theory_references/">References</a></li></ul></li><li><span class="tocitem">User&#39;s Guide</span><ul><li><a class="tocitem" href="../user_guide_getting_started/">1 Getting Started with Radiant</a></li><li><a class="tocitem" href="../user_guide_materials/">2 Materials</a></li><li><a class="tocitem" href="../user_guide_particles/">3 Particles</a></li><li><a class="tocitem" href="../user_guide_cross_sections/">4 Cross-Sections</a></li><li><a class="tocitem" href="../user_guide_geometry/">5 Geometry</a></li><li><a class="tocitem" href="../user_guide_solvers/">6 Solvers</a></li><li><a class="tocitem" href="../user_guide_fixed_external_sources/">7 Fixed External Sources</a></li><li><a class="tocitem" href="../user_guide_transport_calculations/">8 Transport Calculations</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../api_computation_unit/">Computation_Unit</a></li><li><a class="tocitem" href="../api_cross_sections/">Cross_Sections</a></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api_discrete_ordinates/">Discrete_Ordinates</a></li><li><a class="tocitem" href="../api_solvers/">Solvers</a></li></ul></li><li><a class="tocitem" href="../api_geometry/">Geometry</a></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Interactions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api_annihilation/">Annihilation</a></li><li><a class="tocitem" href="../api_auger/">Auger </a></li><li><a class="tocitem" href="../api_bremsstrahlung/">Bremsstrahlung</a></li><li><a class="tocitem" href="../api_compton/">Compton</a></li><li><a class="tocitem" href="../api_elastic_leptons/">Elastic_Leptons</a></li><li><a class="tocitem" href="../api_fluorescence/">Fluorescence</a></li><li><a class="tocitem" href="../api_inelastic_leptons/">Inelastic_Leptons</a></li><li><a class="tocitem" href="../api_pair_production/">Pair_Production</a></li><li><a class="tocitem" href="../api_photoelectric/">Photoelectric</a></li><li><a class="tocitem" href="../api_rayleigh/">Rayleigh</a></li></ul></li><li><a class="tocitem" href="../api_material/">Material</a></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Sources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api_surface_source/">Surface_Source</a></li><li><a class="tocitem" href="../api_volume_source/">Volume_Source</a></li><li><a class="tocitem" href="../api_fixed_source/">Fixed_Sources</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory and Methodology</a></li><li><a class="is-disabled">1 Radiation Transport</a></li><li class="is-active"><a href>1.2 Energy Discretization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>1.2 Energy Discretization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CBienvenue/Radiant.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CBienvenue/Radiant.jl/blob/main/docs/src/theory_energy_discretization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="1.2-Energy-discretization"><a class="docs-heading-anchor" href="#1.2-Energy-discretization">1.2 Energy discretization</a><a id="1.2-Energy-discretization-1"></a><a class="docs-heading-anchor-permalink" href="#1.2-Energy-discretization" title="Permalink"></a></h1><p>The energy domain of the transport equation is discretized using finite-element methods. This discretization defines the structure of the atomic data (cross-sections, stopping powers and momentum transfer) to be prepared for transport calculation.</p><h2 id="1.2.1-Classical-Galerkin-Method-of-Weighted-Residuals"><a class="docs-heading-anchor" href="#1.2.1-Classical-Galerkin-Method-of-Weighted-Residuals">1.2.1 Classical Galerkin Method of Weighted Residuals</a><a id="1.2.1-Classical-Galerkin-Method-of-Weighted-Residuals-1"></a><a class="docs-heading-anchor-permalink" href="#1.2.1-Classical-Galerkin-Method-of-Weighted-Residuals" title="Permalink"></a></h2><figure>
    <img src="../energy_groups.png" alt="drawing" style="width: min(550px, 100vw);"/>
    <figcaption> Figure 1: Energy Discretization.</figcaption>
</figure><p>The energy domain is divided <span>$G$</span> meshes, often refered to as energy group. The convention where <span>$g = 1$</span> corresponds to the highest energy group is used. The midpoint energy of the group <span>$g$</span> is <span>$E_{g}$</span>, its width is <span>$\Delta E_{g}$</span>, and its upper and lower boundaries are respectively <span>$E_{g-1/2}$</span> and <span>$E_{g+1/2}$</span>, as shown in Fig.1. The lower energy boundary of the lowest energy group, <span>$E_{G+1/2}$</span>, is called the cutoff energy. Particles that scatter or are produced under this energy cutoff are considered to be absorbed locally. It also means that charge and energy are deposited locally. This energy should be chosen carefully, being low enough to ensure that the absorbed particle mean free path is lower than the spatial meshes&#39; width to be realistic.</p><p>The classical multigroup method can be applied assuming that the angular flux is separable in energy, as describe in <a href="../theory_references/#lewis1984computational">Lewis and Miller [1]</a>. It also can be developed as a special case of the classical Galerkin method of weighted residuals [<a href="../theory_references/#hesthaven2007nodal">11</a>] applied to the energy domain. The change of variable</p><p class="math-container">\[u = \frac{2E-E_{g-1/2}-E_{g+1/2}}{2\Delta E_{g}} \in [-1/2,1/2]\]</p><p>can be applied to the energy variable <span>$E$</span> to simplify the application of the method. The BFP equation then becomes</p><p class="math-container">\[\begin{split} &amp;\underbrace{\mathbf{\Omega} \cdot \nabla \Phi_{p}(\mathbf{r},\mathbf{\Omega},u)}_{\mathsf{A}} + \underbrace{\Sigma_{t}^{p}(\mathbf{r},u) \Phi_{p}(\mathbf{r},\mathbf{\Omega},u)}_{\mathsf{B}} + \underbrace{\frac{-1}{\Delta E_{g}} \frac{\partial}{\partial u}\left[ S^{p}(\mathbf{r},u)\Phi_{p}(\mathbf{r},\mathbf{\Omega},u) \vphantom{\frac{\partial}{\partial u}} \right]}_{\mathsf{C}} \\ &amp;= \underbrace{Q_{p}^{\texttt{AFP}}(\mathbf{r},\mathbf{\Omega},u)}_{\mathsf{D}} + \underbrace{Q_{p}^{\texttt{B}}(\mathbf{r},\mathbf{\Omega},u)}_{\mathsf{E}} + \underbrace{Q_{p}^{\texttt{ext}}(\mathbf{r},\mathbf{\Omega},u)}_{\mathsf{F}} \,,\end{split}\]</p><p>where the energy derivative in the CSD operator have also been affected by this change of variable. The angular flux in group <span>$g$</span> is expanded up to the <span>$M$</span> order, namely</p><p class="math-container">\[\Phi_{p,g}(\mathbf{r},\mathbf{\Omega},u) = \sum_{m=0}^{M} \tilde{P}_{m}(u) \Phi_{p,g}^{(m)}(\mathbf{r},\mathbf{\Omega}) \,,\]</p><p>such as the moment of the angular flux are given by</p><p class="math-container">\[\Phi_{p,g}^{(m)}(\mathbf{r},\mathbf{\Omega}) = \int_{-1/2}^{1/2}du \tilde{P}_{m}(u) \Phi_{p,g}(\mathbf{r},\mathbf{\Omega},u) \,.\]</p><p>Nonetheless, the total cross-sections, the scattering cross-sections, the momentum transfers and the stopping powers are also expanded up to the <span>$M$</span> order,</p><p class="math-container">\[\Sigma_{t,g}^{p}(\mathbf{r},u) = \sum_{m=0}^{M} \tilde{P}_{m}(u) \Sigma_{t,g}^{p,(m)}(\mathbf{r})\,,\]</p><p class="math-container">\[\Sigma_{s,g&#39;\rightarrow g}^{p&#39;\rightarrow p}(\mathbf{r},\mathbf{\Omega}\cdot\mathbf{\Omega}&#39;,u,u&#39;) = \frac{1}{\Delta E_{g&#39;}} \sum_{m=0}^{M} \sum_{m&#39;=0}^{M} \tilde{P}_{m}(u) \tilde{P}_{m&#39;}(u&#39;) \Sigma_{s,g&#39;\rightarrow g}^{p&#39;\rightarrow p,(m&#39;\rightarrow m)}(\mathbf{r},\mathbf{\Omega}\cdot\mathbf{\Omega}&#39;) \,,\]</p><p class="math-container">\[T_{g}^{p}(\mathbf{r},u) = \sum_{m=0}^{M} \tilde{P}_{m}(u) T_{g}^{p,(m)}(\mathbf{r})\,,\]</p><p class="math-container">\[S_{g}^{p}(\mathbf{r},u) = \sum_{m=0}^{M} \tilde{P}_{m}(u) S_{g}^{p,(m)}(\mathbf{r})\,,\]</p><p>such as their <span>$m$</span>-th moments are given respectively by</p><p class="math-container">\[\Sigma_{t,g}^{p,(m)}(\mathbf{r}) = \int_{-1/2}^{1/2}du \tilde{P}_{m}(u) \Sigma_{t,g}^{p}(\mathbf{r},u)\,,\]</p><p class="math-container">\[\Sigma_{s,g&#39;\rightarrow g}^{p&#39;\rightarrow p,(m&#39;\rightarrow m)}(\mathbf{r},\mathbf{\Omega}\cdot\mathbf{\Omega}&#39;) = \Delta E_{g&#39;} \int_{-1/2}^{1/2}du&#39; \tilde{P}_{m&#39;}(u&#39;)\int_{-1/2}^{1/2}du \tilde{P}_{m}(u) \Sigma_{s,g&#39;\rightarrow g}^{p&#39;\rightarrow p}(\mathbf{r},\mathbf{\Omega}\cdot\mathbf{\Omega}&#39;,u,u&#39;) \,,\]</p><p class="math-container">\[T_{g}^{p,(m)}(\mathbf{r}) = \int_{-1/2}^{1/2}du \tilde{P}_{m}(u) T_{g}^{p}(\mathbf{r},u)\,,\]</p><p class="math-container">\[S_{g}^{p,(m)}(\mathbf{r}) = \int_{-1/2}^{1/2}du \tilde{P}_{m}(u) S_{g}^{p}(\mathbf{r},u)\,.\]</p><p>The goal is to express the BFP equation as a function of these moments, which can be calculated beforehand. Multiplying the BFP equation by the normalized Legendre polynomials <span>$P_{m}(u)$</span> and integrating over <span>$u \in [-1/2,1/2]$</span>, the <span>$m$</span>-th moment of the BFP equation, term-per-term, become </p><p class="math-container">\[\left&lt; \mathsf{A} \right&gt; = \mathbf{\Omega} \cdot \nabla \Phi_{p,g}^{(m)}(\mathbf{r},\mathbf{\Omega}) \,,\]</p><p class="math-container">\[\left&lt;  \mathsf{B} \right&gt; = \sqrt{2m+1} \sum_{j_{2}=0}^{M} \sum_{j_{3}=0}^{M} \sqrt{2j_2+1}\sqrt{2j_3+1} \mathcal{W}_{m,j_2,j_3} \Sigma_{t,g}^{p,(j_{2})}(\mathbf{r}) \Phi_{p,g}^{(j_3)}(\mathbf{r},\mathbf{\Omega}) \,,\]</p><p class="math-container">\[\begin{split} \left&lt;  \mathsf{C} \right&gt; &amp;= -\frac{\sqrt{2m+1}}{\Delta E_{g}} \left\{ S^{p}_{g-1/2}(\mathbf{r})\Phi_{p,g-1/2}(\mathbf{r},\mathbf{\Omega}) - (-1)^{m} S^{p}_{g+1/2}(\mathbf{r})\Phi_{p,g+1/2}(\mathbf{r},\mathbf{\Omega}) \right. \\ &amp;\left.- \sum_{j_{1}=0}^{m-1} \frac{2j_{1}+1}{2} \left[ 1 - (-1)^{m-j_{1}-1} \right] \sum_{j_{2}=0}^{M} \sum_{j_3=0}^{M} \sqrt{2j_2+1}\sqrt{2j_3+1} \mathcal{W}_{j_1,j_2,j_3} S_{g}^{p,(j_{2})}(\mathbf{r})\Phi_{p,g}^{(j_3)}(\mathbf{r},\mathbf{\Omega}) \right\} \,,\end{split}\]</p><p class="math-container">\[\left&lt;  \mathsf{D} \right&gt; = \sqrt{2m+1} \sum_{j_{2}=0}^{M} \sum_{j_{3}=0}^{M} \sqrt{2j_2+1}\sqrt{2j_3+1} \mathcal{W}_{m,j_2,j_3} T_{g}^{p,(j_{2})}(\mathbf{r}) \nabla^{2}_{\Omega}\Phi_{p,g}^{(j_3)}(\mathbf{r},\mathbf{\Omega}) \,,\]</p><p class="math-container">\[\left&lt;  \mathsf{E} \right&gt; = \frac{1}{2\pi} \sum_{p&#39; \in P} \int_{\mathbb{S}^2}d^{2}\Omega&#39; \sum_{g&#39;=1}^{G+1} \sum_{m&#39;=0}^{M} \Sigma_{s,g&#39;\rightarrow g}^{p&#39;\rightarrow p,(m&#39;\rightarrow m)}(\mathbf{r},\mathbf{\Omega}\cdot\mathbf{\Omega}&#39;) \Phi_{p&#39;,g&#39;}^{(m&#39;)}(\mathbf{r},\mathbf{\Omega}&#39;) \,,\]</p><p>and <span>$\left&lt;\mathsf{F}\right&gt;$</span> is calculated depending on the definition of the fixed external source inside the medium volume. The function <span>$\mathcal{W}_{j_1,j_2,j_3}$</span> is defined as</p><p class="math-container">\[\mathcal{W}_{j_1,j_2,j_3} = \frac{1}{2}\int_{-1}^{1}dx P_{j_1}(x) P_{j_2}(x) P_{j_3}(x) \,.\]</p><p>The variables <span>$S^{p}_{g\pm1/2}(\mathbf{r})$</span> and <span>$\Phi_{p,g\pm1/2}(\mathbf{r},\mathbf{\Omega})$</span> are the stopping powers and angular flux at the higher (index g-1/2) and lower (index g+1/2) boundaries. These incoming and outgoing flux at energy group boundaries requires to define a closure relation, which will be defined later.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>RADIANT does not include yet all the capabilities for generalized (<span>$M &gt; 0$</span>) Galerkin discretization in energy. It includes generalization for any <span>$M$</span> only for the CSD term, while also assuming that the stopping powers moments are given by </p><p class="math-container">\[S_{g}^{p,(0)}(\mathbf{r}) = \frac{1}{2} \left[ S^{p}_{g-1/2}(\mathbf{r}) + S^{p}_{g+1/2}(\mathbf{r})\right]\,,\]</p><p class="math-container">\[S_{g}^{p,(1)}(\mathbf{r}) = \frac{1}{2\sqrt{3}} \left[ S^{p}_{g-1/2}(\mathbf{r}) - S^{p}_{g+1/2}(\mathbf{r})\right] \,,\]</p><p>and</p><p class="math-container">\[S_{g}^{p,(m)}(\mathbf{r}) = 0 \quad \forall \, m \ge 2 \,.\]</p><p>For all other terms, the following multigroup discretisation is used.</p></div></div><h2 id="1.2.2-Multigroup-Discretization"><a class="docs-heading-anchor" href="#1.2.2-Multigroup-Discretization">1.2.2 Multigroup Discretization</a><a id="1.2.2-Multigroup-Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#1.2.2-Multigroup-Discretization" title="Permalink"></a></h2><p>The multigroup discetization is the most employed energy discretization method. It is assumed that the particles define in the same energy group share the same energy and averaged energy-dependent variables. The classical multigroup method can be obtained assuming that the angular flux is separable in energy, as describe in <a href="../theory_references/#lewis1984computational">Lewis and Miller [1]</a>. It also correspond to taking the Galerkin method of weighted residuals up to order <span>$M = 0$</span>. The group-averaged angular flux in group <span>$g$</span> is therefore given by</p><p class="math-container">\[\Phi_{p,g}(\mathbf{r},\mathbf{\Omega},E) = \Phi_{p,g}(\mathbf{r},\mathbf{\Omega}) \,,\]</p><p>with</p><p class="math-container">\[\Phi_{p,g}(\mathbf{r},\mathbf{\Omega}) = \frac{1}{\Delta E_{g}} \int_{E_{g+1/2}}^{E_{g-1/2}}dE \Phi_{p,g}(\mathbf{r},\mathbf{\Omega},E) \,,\]</p><p>where the order index <span>$(0)$</span> is and will omitted in the following section. The group-averaged total cross-sections, scattering cross-sections, momentum transfers and stopping powers are then given by</p><p class="math-container">\[\Sigma_{t,g}^{p}(\mathbf{r}) = \frac{1}{\Delta E_{g}}\int_{E_{g+1/2}}^{E_{g-1/2}}dE \Sigma_{t,g}^{p}(\mathbf{r},E) \,,\]</p><p class="math-container">\[\Sigma_{s,g&#39;\rightarrow g}^{p&#39;\rightarrow p}(\mathbf{r},\mathbf{\Omega}\cdot\mathbf{\Omega}&#39;) = \frac{1}{\Delta E_{g}} \int_{E_{g+1/2}}^{E_{g-1/2}}dE \int_{E_{g&#39;+1/2}}^{E_{g&#39;-1/2}}dE&#39; \Sigma_{s,g&#39;\rightarrow g}^{p&#39;\rightarrow p}(\mathbf{r},E&#39;\rightarrow E,\mathbf{\Omega}\cdot\mathbf{\Omega}&#39;) \,,\]</p><p class="math-container">\[T_{g}^{p}(\mathbf{r}) = \frac{1}{\Delta E_{g}}\int_{E_{g+1/2}}^{E_{g-1/2}}dE  T_{g}^{p}(\mathbf{r},E) \,,\]</p><p class="math-container">\[S_{g}^{p}(\mathbf{r}) = \frac{1}{\Delta E_{g}}\int_{E_{g+1/2}}^{E_{g-1/2}}dE  S_{g}^{p}(\mathbf{r},E) \,.\]</p><p>Because of the energy derivative, transport calculations also requires boundary values of the stopping powers, namely</p><p class="math-container">\[S_{g-1/2}^{p}(\mathbf{r}) = S^{p}(\mathbf{r},E_{g-1/2}) \quad\text{and}\quad S_{g+1/2}^{p}(\mathbf{r}) = S^{p}(\mathbf{r},E_{g+1/2}) \,.\]</p><p>The zeroth-th moment of the BFP equation, term-per-term, is given by</p><p class="math-container">\[\left&lt; \mathsf{A} \right&gt; = \mathbf{\Omega} \cdot \nabla \Phi_{p,g}(\mathbf{r},\mathbf{\Omega}) \,,\]</p><p class="math-container">\[\left&lt;  \mathsf{B} \right&gt; = \Sigma_{t,g}^{p}(\mathbf{r}) \Phi_{p,g}(\mathbf{r},\mathbf{\Omega}) \,,\]</p><p class="math-container">\[\begin{split} \left&lt;  \mathsf{C} \right&gt; &amp;= -\frac{1}{\Delta E_{g}} \left\{ S^{p}_{g-1/2}(\mathbf{r})\Phi_{p,g-1/2}(\mathbf{r},\mathbf{\Omega}) - S^{p}_{g+1/2}(\mathbf{r})\Phi_{p,g+1/2}(\mathbf{r},\mathbf{\Omega}) \right\} \,,\end{split}\]</p><p class="math-container">\[\left&lt;  \mathsf{D} \right&gt; = T_{g}^{p}(\mathbf{r}) \nabla^{2}_{\Omega}\Phi_{p,g}(\mathbf{r},\mathbf{\Omega}) \,,\]</p><p class="math-container">\[\left&lt;  \mathsf{E} \right&gt; = \frac{1}{2\pi} \sum_{p&#39; \in P} \int_{\mathbb{S}^2}d^{2}\Omega&#39; \sum_{g&#39;=1}^{G+1} \Sigma_{s,g&#39;\rightarrow g}^{p&#39;\rightarrow p}(\mathbf{r},\mathbf{\Omega}\cdot\mathbf{\Omega}&#39;) \Phi_{p&#39;,g&#39;}(\mathbf{r},\mathbf{\Omega}&#39;) \,,\]</p><p>and <span>$\left&lt;\mathsf{F}\right&gt;$</span> is calculated depending on the definition of the fixed external source inside the medium volume.</p><h2 id="1.2.3-Energy-Group-Structure"><a class="docs-heading-anchor" href="#1.2.3-Energy-Group-Structure">1.2.3 Energy Group Structure</a><a id="1.2.3-Energy-Group-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#1.2.3-Energy-Group-Structure" title="Permalink"></a></h2><p>The energy domain can be discretized using three pieces of information: the number of groups, <span>$G$</span>, the mid-point energy of the highest energy group, <span>$E_1$</span>, and the cutoff energy <span>$E_{G+1/2}$</span>.</p><h3 id="1.2.3.1-Linear-Structure"><a class="docs-heading-anchor" href="#1.2.3.1-Linear-Structure">1.2.3.1 Linear Structure</a><a id="1.2.3.1-Linear-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#1.2.3.1-Linear-Structure" title="Permalink"></a></h3><p>The linear structure is characterized by same-size energy group. The mathbftor containing its energy boundaries is given by</p><p class="math-container">\[\mathbf{E} = \left\{ E_{G+1/2} + \frac{k(E_{1/2}-E_{G+1/2})}{G} \mid k = 0,1,2,...,G \right\}\,,\]</p><p>where the higher bound of the maximum energy group is given by</p><p class="math-container">\[E_{1/2} = E_{1} + \frac{E_{1}-E_{G+1/2}}{2G+1} \,.\]</p><h3 id="1.2.3.2-Logarithmic-Structure"><a class="docs-heading-anchor" href="#1.2.3.2-Logarithmic-Structure">1.2.3.2 Logarithmic Structure</a><a id="1.2.3.2-Logarithmic-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#1.2.3.2-Logarithmic-Structure" title="Permalink"></a></h3><p>The logarithmic structure is given by</p><p class="math-container">\[\mathbf{E} = \left\{ 10^{\log_{10}{E_{G+1/2}} + \frac{k(\log_{10}{E_{1/2}}-\log_{10}{E_{G+1/2}})}{G}} \mid k = 0,1,2,...,G \right\}\,.\]</p><p>The higher bound of the maximum energy group is given by solving</p><p class="math-container">\[2E_{1} - E_{1/2} - 10^{\log_{10}{E_{1/2}} - \left(\log_{10}{E_{1/2}}-\log_{10}{E_{G+1/2}}\right)/G} = 0\]</p><p>using a root-finding algorithm.</p><h2 id="1.2.4-Definition-of-soft-and-catastrophic-interactions"><a class="docs-heading-anchor" href="#1.2.4-Definition-of-soft-and-catastrophic-interactions">1.2.4 Definition of soft and catastrophic interactions</a><a id="1.2.4-Definition-of-soft-and-catastrophic-interactions-1"></a><a class="docs-heading-anchor-permalink" href="#1.2.4-Definition-of-soft-and-catastrophic-interactions" title="Permalink"></a></h2><figure>
    <img src="../soft_catas_cutoff.jpg" alt="drawing" style="width: min(750px, 100vw);"/>
    <figcaption> Figure 2: Definition of soft and catastrophic interactions.</figcaption>
</figure><p>The definition of soft and catastrophic domains on the energy spectrum at group boundaries are shown in Fig.2, where two points <span>$(E,E_{c}(E))$</span> are defined as <span>$(E_{g-1/2},E_{g+1/2})$</span> and <span>$(E_{g+1/2},E_{g+3/2})$</span> for any group <span>$g$</span>, with the additional definition <span>$E_{G+3/2} = 0$</span>. A smooth transition between these two coordinates is required and is set to be linear in <span>$E$</span>. The resulting energy dividing the soft and catastrophic domains, for <span>$E \in [E_{g-1/2},E_{g+1/2}]$</span>, is given by</p><p class="math-container">\[E_{c}(E) = \left(\frac{E_{g+1/2}-E_{g+3/2}}{E_{g-1/2}-E_{g+1/2}}\right) E - \frac{E_{g+1/2}^2-E_{g-1/2}E_{g+3/2}}{E_{g-1/2}-E_{g+1/2}}\]</p><p>for any <span>$1 \le g \le G$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory_transport_equation/">« 1.1 The Transport Equation</a><a class="docs-footer-nextpage" href="../theory_angular_discretization/">1.3 Angular Discretization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.0 on <span class="colophon-date" title="Monday 31 March 2025 18:26">Monday 31 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
